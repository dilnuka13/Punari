<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Punari üíó</title>
    <!-- Tailwind CSS (Fixed & Reliable) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Noto+Sans+Sinhala:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        love: '#e91e63', 
                        deep: '#880e4f',
                        gold: '#ffd700',
                        bg: '#fce4ec',
                    },
                    fontFamily: {
                        hand: ['"Dancing Script"', 'cursive'],
                        sinhala: ['"Noto Sans Sinhala"', 'sans-serif'],
                        body: ['"Poppins"', 'sans-serif'],
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'heartbeat': 'heartbeat 1.5s ease-in-out infinite both',
                        'pop-in': 'popIn 0.3s ease-out forwards',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        heartbeat: {
                            '0%': { transform: 'scale(1)' },
                            '14%': { transform: 'scale(1.3)' },
                            '28%': { transform: 'scale(1)' },
                            '42%': { transform: 'scale(1.3)' },
                            '70%': { transform: 'scale(1)' },
                        },
                        popIn: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { overscroll-behavior: none; }

        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }

        .photo-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 1.5s ease-in-out, transform 6s ease;
            opacity: 0;
            transform: scale(1);
        }
        .photo-slide.active {
            opacity: 1;
            transform: scale(1.1);
        }

        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #f8bbd0, #e91e63);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 1s ease;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            transition: width 5s linear;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        @keyframes laughFloat {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        .countdown-box {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            min-width: 70px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
        .countdown-number {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 1.8rem;
            color: #e91e63;
        }
        .countdown-label {
            font-family: 'Noto Sans Sinhala', sans-serif;
            font-size: 0.75rem;
            color: #880e4f;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>
<body class="bg-bg h-[100dvh] overflow-hidden relative font-body">

    <!-- Audio -->
    <audio id="bgMusic" loop>
        <source src="https://dilnuka13.github.io/Punari/12.mp3" type="audio/mpeg">
    </audio>

    <!-- ===== SECTION 1: VALENTINE DAY APP ===== -->
    <div id="valentine-app" class="hidden w-full h-full absolute inset-0">
        
        <!-- STEP 1: ENVELOPE -->
        <div id="envelope-screen" class="absolute z-50 w-full h-full flex items-center justify-center p-4 bg-bg">
            <div class="cursor-pointer group relative w-72 h-48 bg-love rounded-lg shadow-2xl flex items-center justify-center transform hover:scale-105 transition-transform duration-300" onclick="startIntro()">
                <div class="absolute top-0 left-0 w-0 h-0 border-l-[144px] border-l-transparent border-t-[100px] border-t-pink-800/50 border-r-[144px] border-r-transparent origin-top z-20"></div>
                <div class="z-30 w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg animate-pulse-fast">
                    <i class="fa-solid fa-heart text-love text-3xl"></i>
                </div>
                <p class="absolute -bottom-16 text-deep font-hand text-3xl font-bold animate-bounce">For Punari üíó</p>
            </div>
        </div>

        <!-- STEP 2: INTRO -->
        <div id="intro-screen" class="intro-overlay hidden">
            <i class="fa-solid fa-heart text-white text-6xl animate-heartbeat mb-4"></i>
            <h2 class="text-white font-hand text-3xl">Opening Surprise...</h2>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <p class="text-white/80 mt-2 font-body text-sm">Wait for it...</p>
        </div>

        <!-- STEP 3: MAIN CARD -->
        <div id="main-card" class="hidden opacity-0 w-full h-full max-w-md mx-auto bg-white/20 backdrop-blur-xl relative flex flex-col overflow-hidden transition-opacity duration-1000">
            
            <button onclick="toggleMusic()" class="absolute top-4 right-4 z-40 bg-white/50 p-2 rounded-full text-deep hover:bg-white transition-all shadow-md">
                <i id="musicIcon" class="fa-solid fa-music"></i>
            </button>

            <!-- Photo Slider -->
            <div class="relative w-full aspect-square overflow-hidden shadow-lg rounded-b-[40px] z-10 bg-pink-50">
                <img src="https://scontent.fcmb2-2.fna.fbcdn.net/v/t39.30808-6/590735337_122261993516190533_2731158900885363343_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=127cfc&_nc_ohc=hGL4-U8cg4YQ7kNvwGuPizE&_nc_oc=Adl6dmdvKZNBgd9xsJvFmh9gqypiMqBPKpy_dl-n4gZD9m1YbRm0f5ZJZRXgKK5T0Dk&_nc_zt=23&_nc_ht=scontent.fcmb2-2.fna&_nc_gid=egnUITjCJPiDzaOgAWVzwg&oh=00_AfsDqCLfMynhvzH0uhUIOsUkgV0e4eW8nxI3W1DAYRgm1A&oe=69963810" class="photo-slide active" alt="Punari">
                <img src="https://scontent.fcmb2-2.fna.fbcdn.net/v/t39.30808-6/591733394_122261993486190533_7313989285083390642_n.jpg?_nc_cat=111&ccb=1-7&_nc_sid=127cfc&_nc_ohc=iQK3Zbk3R3UQ7kNvwH-L5ws&_nc_oc=Admw8qw7txxzgjdEAACv1Pin2Kz_VWx9P5G5Qp99pNaWjg1s5LXx8DNhKb6kxNLBjY0&_nc_zt=23&_nc_ht=scontent.fcmb2-2.fna&_nc_gid=kMXzQI6PGdRviiiiX06qKQ&oh=00_Aft6-er7NBPCJePEs2Ug5uDjssUZOo0IjYcI2H-LxCoICg&oe=69962573" class="photo-slide" alt="Punari">
                
                <div class="absolute inset-0 bg-gradient-to-t from-bg via-transparent to-transparent opacity-90"></div>
                
                <div class="absolute bottom-6 left-0 right-0 text-center px-4">
                    <h1 class="font-hand text-4xl text-deep drop-shadow-md">Happy Valentine's Day Punari</h1>
                </div>
            </div>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto px-6 py-4 flex flex-col items-center text-center space-y-4 relative z-20 pb-4">
                
                <div class="bg-white/60 p-4 rounded-2xl shadow-sm border border-white w-full transform hover:scale-105 transition-transform duration-300">
                    <p class="font-sinhala text-gray-700 leading-relaxed text-md">
                        ‡∂∏‡∑ö Valentine ‡∂ë‡∂ö‡∑ö ‡∂î‡∂∫‡∑è‡∂ß ‡∂Ω‡∑ê‡∂∂‡∑ô‡∂±‡∑ä‡∂± ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∑Ñ‡∑ê‡∂∏ ‡∑É‡∂≠‡∑î‡∂ß‡∂ö‡∑ä‡∂∏ ‡∂Ω‡∑ê‡∂∂‡∑ô‡∂±‡∑ä‡∂± ‡∂ï‡∂±. <br>
                        <span class="font-hand text-love text-2xl block mt-2 drop-shadow-sm">"You carry a little bit of magic in your smile. ‚ú®"</span>
                    </p>
                </div>

                <button onclick="openHints()" class="bg-love/10 text-love px-4 py-2 rounded-full font-bold text-sm border border-love/20 hover:bg-love/20 transition-all flex items-center gap-2">
                    <i class="fa-solid fa-face-grin-wink"></i> Tap for a Secret Message
                </button>

                <div class="w-full relative py-2">
                    <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-deep/20"></div></div>
                    <div class="relative flex justify-center text-xs"><span class="px-2 bg-transparent text-deep/60 font-body uppercase tracking-widest">Future Wish</span></div>
                </div>

                <div class="font-sinhala text-deep font-medium italic text-sm">
                    "‡∂Ö‡∂±‡∑è‡∂ú‡∂≠‡∑ö ‡∂Ø‡∑Ä‡∑É‡∂ö ‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∑Ñ‡∑ì‡∂± ‡∂î‡∂ö‡∑ä‡∂ö‡∑ú‡∂∏ ‡∑Ñ‡∑ê‡∂∂‡∑ë ‡∑Ä‡∑ô‡∂Ω‡∑è, ‡∂Ω‡∑É‡∑ä‡∑É‡∂±‡∂∏ ‡∂Ω‡∑É‡∑ä‡∑É‡∂± ‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∂∫‡∂ö‡∑ä ‡∂î‡∂∫‡∑è‡∂ß ‡∂Ω‡∑ê‡∂∂‡∑ô‡∂±‡∑ä‡∂± ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂∏‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∑è‡∂ª‡∑ä‡∂Æ‡∂±‡∑è ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è. 
                    <br>‡∑Ñ‡∑í‡∂±‡∑è ‡∑Ä‡∑ô‡∂Ω‡∑è ‡∂â‡∂±‡∑ä‡∂± ‡∑Ñ‡∑ê‡∂∏‡∂Ø‡∑è‡∂∏! üíó"
                </div>

                <a href="https://wa.me/94716155666?text=Happy%20Valentine's%20Day%20Isara!%20%E2%9D%A4%EF%B8%8F" 
                   target="_blank"
                   class="inline-flex items-center justify-center space-x-2 bg-[#25D366] hover:bg-[#128C7E] text-white font-medium text-sm py-2 px-6 rounded-full transition-all transform hover:scale-105 shadow-md border border-white/30 no-underline mt-2">
                    <i class="fa-brands fa-whatsapp text-lg"></i>
                    <span>Reply</span>
                </a>

                <div class="w-full pt-6 pb-2">
                    <a href="https://isaradilnuka.netlify.app/" target="_blank" class="flex flex-col items-center justify-center group opacity-70 hover:opacity-100 transition-all duration-300 no-underline">
                        <img src="https://isaradilnuka.netlify.app/titlebar.png" alt="Isara Dilnuka Logo" class="h-6 w-auto mb-1 drop-shadow-sm group-hover:scale-110 transition-transform">
                        <span class="text-[10px] text-deep/60 font-body uppercase tracking-widest group-hover:text-deep transition-colors">Designed by Isara Dilnuka</span>
                    </a>
                </div>

            </div>
        </div>

        <!-- POPUP: Fun Hints -->
        <div id="hints-popup" class="popup-overlay hidden animate-pop-in" onclick="closeHints()">
            <div class="bg-white/90 p-6 rounded-2xl max-w-xs w-full m-4 shadow-2xl text-center border-2 border-love/20 relative" onclick="event.stopPropagation()">
                <button onclick="closeHints()" class="absolute top-2 right-3 text-gray-400 hover:text-red-500 text-xl">&times;</button>
                
                <h3 class="font-hand text-2xl text-love mb-4">Just Kidding! üòú</h3>
                
                <div class="space-y-4 text-left">
                    <div class="flex items-start gap-3 bg-pink-50 p-3 rounded-lg">
                        <i class="fa-solid fa-heart-circle-bolt text-love mt-1"></i>
                        <p class="font-sinhala text-gray-700 text-sm font-bold">"‡∂â‡∂ö‡∑ä‡∂∏‡∂±‡∂ß ‡∂ö‡∑ú‡∂Ω‡∑ä‡∂Ω‡∑ô‡∂ö‡∑ä ‡∑É‡∑ô‡∂ß‡∑ä ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±..."</p>
                    </div>
                    <div class="flex items-start gap-3 bg-pink-50 p-3 rounded-lg">
                        <i class="fa-solid fa-hourglass-half text-love mt-1"></i>
                        <p class="font-sinhala text-gray-700 text-sm">"‡∂±‡∑ê‡∂≠‡∑ä‡∂≠‡∂∏‡∑ä ‡∂â‡∂≠‡∑í‡∂±‡∑ä... ‡∂Ø‡∂±‡∑ä‡∂±‡∑Ä‡∂±‡∑ö? <br><span class="text-xs text-gray-500 font-bold">(‡∂Ö‡∂¥‡∑í ‡∂≠‡∑è‡∂∏ ‡∂∂‡∂Ω‡∂±‡∑ä ‡∂â‡∂±‡∑ä‡∂±‡∑Ä‡∑è... üòå)</span>"</p>
                    </div>
                </div>

                <button onclick="triggerHahaAnimation()" class="mt-6 bg-love text-white px-6 py-2 rounded-full text-sm font-bold shadow-lg hover:bg-deep transition-all">
                    Okay! üòÇ
                </button>
            </div>
        </div>
    </div>

    <!-- ===== SECTION 2: COUNTDOWN APP ===== -->
    <div id="countdown-app" class="hidden w-full h-full absolute inset-0 flex flex-col items-center justify-center bg-bg">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
             <div class="absolute top-10 left-10 text-love/20 text-6xl animate-float"><i class="fa-solid fa-heart"></i></div>
             <div class="absolute bottom-20 right-10 text-deep/20 text-4xl animate-bounce"><i class="fa-solid fa-heart"></i></div>
        </div>

        <div class="z-10 text-center space-y-6 p-6">
            <h1 class="font-hand text-5xl text-deep drop-shadow-md">Next Valentine's Day</h1>
            <p class="font-body text-gray-500 text-sm tracking-wide">IS COMING IN</p>
            
            <div class="flex flex-wrap justify-center gap-4">
                <div class="countdown-box">
                    <div id="cd-days" class="countdown-number">00</div>
                    <div class="countdown-label">Days</div>
                </div>
                <div class="countdown-box">
                    <div id="cd-hours" class="countdown-number">00</div>
                    <div class="countdown-label">Hours</div>
                </div>
                <div class="countdown-box">
                    <div id="cd-minutes" class="countdown-number">00</div>
                    <div class="countdown-label">Mins</div>
                </div>
                <div class="countdown-box">
                    <div id="cd-seconds" class="countdown-number">00</div>
                    <div class="countdown-label">Secs</div>
                </div>
            </div>

            <p class="font-sinhala text-deep/70 mt-8 text-sm">
                "‡∂¥‡∑î‡∂Ç‡∂†‡∑í ‡∂Ø‡∑ö‡∑Ä‡∂Ω‡∑ä ‡∑Ä‡∑ô‡∂±‡∑î‡∑Ä‡∑ô‡∂±‡∑ä ‡∂∂‡∂Ω‡∂±‡∑ä ‡∂â‡∂±‡∑ä‡∂± ‡∂ë‡∂ö‡∂≠‡∑ä ‡∂Ω‡∑É‡∑ä‡∑É‡∂±‡∂∫‡∑í..." <br> üíó
            </p>
        </div>

        <div class="absolute bottom-6 w-full text-center">
            <a href="https://isaradilnuka.netlify.app/" target="_blank" class="flex flex-col items-center justify-center group opacity-60 hover:opacity-100 transition-all duration-300 no-underline">
                <img src="https://isaradilnuka.netlify.app/titlebar.png" alt="Logo" class="h-5 w-auto mb-1 opacity-70">
            </a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            checkDateAndDisplay();
        });

        function checkDateAndDisplay() {
            const now = new Date();
            const month = now.getMonth(); // 0 = Jan, 1 = Feb
            const date = now.getDate();

            const valentineApp = document.getElementById('valentine-app');
            const countdownApp = document.getElementById('countdown-app');

            // Set this to true to force test the card view
            const testingMode = false; 

            if ((month === 1 && date === 14) || testingMode) {
                valentineApp.classList.remove('hidden');
                countdownApp.classList.add('hidden');
            } else {
                valentineApp.classList.add('hidden');
                countdownApp.classList.remove('hidden');
                startCountdown();
            }
        }

        function startCountdown() {
            const now = new Date();
            let year = now.getFullYear();
            let nextValentine = new Date(year, 1, 14, 0, 0, 0);

            if (now.getTime() > nextValentine.getTime()) {
                nextValentine.setFullYear(year + 1);
            }

            const timer = setInterval(() => {
                const currentTime = new Date().getTime();
                const distance = nextValentine.getTime() - currentTime;

                if (distance < 0) {
                    clearInterval(timer);
                    location.reload();
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('cd-days').innerText = days < 10 ? '0' + days : days;
                document.getElementById('cd-hours').innerText = hours < 10 ? '0' + hours : hours;
                document.getElementById('cd-minutes').innerText = minutes < 10 ? '0' + minutes : minutes;
                document.getElementById('cd-seconds').innerText = seconds < 10 ? '0' + seconds : seconds;
            }, 1000);
        }

        function startIntro() {
            const envelope = document.getElementById('envelope-screen');
            const intro = document.getElementById('intro-screen');
            
            envelope.style.transition = "all 0.5s ease";
            envelope.style.transform = "scale(0.8) translateY(-50px)";
            envelope.style.opacity = "0";

            setTimeout(() => {
                envelope.style.display = 'none';
                intro.classList.remove('hidden');
                intro.style.display = 'flex';
                
                setTimeout(() => {
                    document.getElementById('progress-fill').style.width = "100%";
                }, 100);

                setTimeout(showMainCard, 5000);
            }, 500);
        }

        function showMainCard() {
            const intro = document.getElementById('intro-screen');
            const card = document.getElementById('main-card');
            const audio = document.getElementById('bgMusic');
            const icon = document.getElementById('musicIcon');
            
            intro.style.opacity = '0';
            
            setTimeout(() => {
                intro.style.display = 'none';
                card.classList.remove('hidden');
                
                audio.play().then(() => {
                    icon.classList.remove('fa-play');
                    icon.classList.remove('fa-music');
                    icon.classList.add('fa-pause');
                }).catch(e => {
                    console.log("Audio autoplay blocked");
                });

                setTimeout(() => {
                    card.classList.remove('opacity-0');
                    startSlideshow();
                }, 100);
            }, 1000);
        }

        function openHints() {
            const popup = document.getElementById('hints-popup');
            popup.classList.remove('hidden');
            popup.classList.add('flex');
        }

        function closeHints() {
            const popup = document.getElementById('hints-popup');
            popup.classList.add('hidden');
            popup.classList.remove('flex');
        }

        function triggerHahaAnimation() {
            closeHints();
            const emojis = ['üòÇ', 'ü§£', 'üòπ', 'üòÜ'];
            for(let i=0; i<50; i++) {
                const el = document.createElement('div');
                el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                el.style.position = 'fixed';
                el.style.left = Math.random() * 100 + 'vw';
                el.style.top = '110vh';
                el.style.fontSize = (Math.random() * 30 + 20) + 'px';
                el.style.zIndex = '9999';
                el.style.pointerEvents = 'none';
                const duration = Math.random() * 2 + 3; 
                el.style.animation = `laughFloat ${duration}s ease-out forwards`;
                document.body.appendChild(el);
                setTimeout(() => { el.remove(); }, duration * 1000);
            }
        }

        let currentSlide = 0;
        function startSlideshow() {
            const slides = document.querySelectorAll('.photo-slide');
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000); 
        }

        function toggleMusic() {
            const audio = document.getElementById('bgMusic');
            const icon = document.getElementById('musicIcon');
            if(audio.paused) {
                audio.play();
                icon.classList.remove('fa-play');
                icon.classList.remove('fa-music');
                icon.classList.add('fa-pause');
            } else {
                audio.pause();
                icon.classList.remove('fa-pause');
                icon.classList.add('fa-play');
            }
        }
    </script>
</body>
</html>
